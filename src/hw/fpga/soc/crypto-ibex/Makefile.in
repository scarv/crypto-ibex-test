# Copyright (C) 2021 SCARV project <info@scarv.org>
#
# Use of this source code is restricted per the MIT license, a copy of which 
# can be found at https://opensource.org/licenses/MIT (or should be included 
# as LICENSE.txt within the associated archive or repository).

#--------------------------------------------------------------------
# Collect crypto-ibex Verilog
#--------------------------------------------------------------------
fpga-ibex-rtl = $(IBEX_REPO)/build/lowrisc_ibex_ibex_simple_system_0/src/lowrisc_ibex_ibex_core_0.1/rtl
fpga-ibex-core = $(FPGA_BUILD)/$(VIVADO_PROJECT)/rtl_sources/ibex_core.v

$(SOC)_verilog: $(fpga-ibex-core) $(FPGA)/soc/$(SOC)/system_top_wrapper.v 
	mkdir -p $(FPGA_BUILD)/$(VIVADO_PROJECT)/prog-bin
	cp -f $(FPGA)/soc/$(SOC)/bootrom/bootrom.coe       $(FPGA_BUILD)/$(VIVADO_PROJECT)/prog-bin/
	cp -f $(FPGA)/soc/$(SOC)/system_top_wrapper.v      $(FPGA_BUILD)/$(VIVADO_PROJECT)/rtl_sources/system_top_wrapper.v
	cp -f $(FPGA)/soc/$(SOC)/ibex_wrapper.sv           $(FPGA_BUILD)/$(VIVADO_PROJECT)/rtl_sources/ibex_wrapper.sv
	cp -f $(ibex_support_src)                          $(FPGA_BUILD)/$(VIVADO_PROJECT)/rtl_sources/

$(fpga-ibex-core) : 
	mkdir -p $(FPGA_BUILD)/$(VIVADO_PROJECT)/rtl_sources
	source $(FPGA)/soc/$(SOC)/script/convert.sh




